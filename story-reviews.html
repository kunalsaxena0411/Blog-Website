<!DOCTYPE html>
<html lang="hi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>कहानी समीक्षाएं - गामाकौआ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Base font-family and smooth scroll behavior */
      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: "Noto Sans Devanagari", "Inter", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        /* New background image: abstract black and white pattern from Unsplash */
        background-image: url("https://images.unsplash.com/photo-1518495973347-1f4806a6c4b2?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"); /* Unsplash B&W abstract image */
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        background-color: #0d1a2f; /* Fallback dark color */
        color: #e2e8f0; /* Default light text color */
      }

      /* Header styling with glass morphism effect */
      header {
        background: rgba(
          26,
          32,
          44,
          0.7
        ); /* Darker, more transparent for glass effect */
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        color: #e2e8f0;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }

      /* Content section with glass morphism effect */
      .content-overlay {
        background: rgba(
          255,
          255,
          255,
          0.75
        ); /* Light, more transparent white for glass effect */
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 1rem;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        color: #374151; /* Darker text inside content overlays */
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .content-overlay:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      /* Gradient text for headings (optional, consistent with main page) */
      .gradient-text {
        background: linear-gradient(90deg, #3b82f6, #10b981);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      /* Modal specific styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }

      .modal-overlay.open {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background: white;
        padding: 2.5rem;
        border-radius: 1rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        position: relative;
        max-width: 90%;
        width: 600px; /* Increased width for better review display */
        transform: scale(0.8);
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(245, 245, 245, 0.95) 100%
        );
        max-height: 80vh; /* Limit modal height */
        overflow-y: auto; /* Enable scrolling for long content */
      }

      .modal-overlay.open .modal-content {
        transform: scale(1);
      }

      .close-button {
        position: absolute;
        top: 1rem;
        right: 1rem;
        font-size: 1.5rem;
        cursor: pointer;
        color: #4a5568;
        transition: all 0.2s ease-in-out;
      }

      .close-button:hover {
        color: #ef4444;
        transform: rotate(90deg);
      }

      /* Floating action button (Back to Top) */
      .floating-btn {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #3b82f6, #10b981);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        cursor: pointer;
        z-index: 999;
        transition: all 0.3s ease;
      }

      .floating-btn:hover {
        transform: scale(1.1) rotate(10deg);
        box-shadow: 0 15px 30px rgba(16, 185, 129, 0.4);
      }

      /* Hindi font adjustments */
      .hindi-text {
        line-height: 1.8;
        letter-spacing: 0.5px;
      }

      /* Success message styling */
      .success-message {
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #10b981, #3b82f6);
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        z-index: 1001;
        display: flex;
        align-items: center;
        transform: translateX(150%);
        transition: transform 0.3s ease-out;
      }

      .success-message.show {
        transform: translateX(0);
      }

      /* User profile dropdown */
      .profile-dropdown {
        position: relative;
        display: inline-block;
      }

      .profile-btn {
        display: flex;
        align-items: center;
        cursor: pointer;
      }

      .profile-img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin-right: 8px;
        object-fit: cover;
        border: 2px solid #3b82f6;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background-color: #1e293b;
        min-width: 200px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 8px;
        overflow: hidden;
      }

      .dropdown-content a {
        color: white;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        transition: background-color 0.3s;
      }

      .dropdown-content a:hover {
        background-color: #334155;
      }

      .profile-dropdown:hover .dropdown-content {
        display: block;
      }

      /* Post blog button styling */
      .post-blog-btn {
        background: linear-gradient(135deg, #3b82f6, #10b981);
        color: white;
        font-weight: bold;
        padding: 10px 20px;
        border-radius: 9999px;
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
      }

      .post-blog-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
      }

      .post-blog-btn i {
        margin-right: 8px;
      }

      /* Auth required modal */
      .auth-required-modal {
        text-align: center;
      }

      .auth-required-modal .modal-content {
        max-width: 400px;
      }

      .auth-required-modal h3 {
        margin-bottom: 16px;
      }

      .auth-required-buttons {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin-top: 24px;
      }

      /* Blog editor styling */
      .editor-toolbar {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
        flex-wrap: wrap;
      }

      .editor-btn {
        background: #e2e8f0;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.2s;
      }

      .editor-btn:hover {
        background: #cbd5e1;
      }

      .editor-btn.active {
        background: #94a3b8;
        color: white;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .logo-text {
          font-size: 1.2rem;
        }

        .logo-img {
          width: 40px;
          height: 40px;
        }

        .post-blog-btn {
          padding: 8px 16px;
          font-size: 0.9rem;
        }

        .auth-required-buttons {
          flex-direction: column;
          gap: 8px;
        }
      }

      /* Custom styling for article detail modal content for better readability */
      #articleDetailContent {
        white-space: pre-wrap; /* Preserves whitespace and wraps text */
        word-break: break-word; /* Breaks long words */
      }
      /* Loader styles */
      .loader {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3b82f6;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 2s linear infinite;
        margin: 0 auto;
        display: none;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body class="text-gray-800" data-category="story-reviews">
    <!-- Success Message Container -->
    <div id="successMessage" class="success-message">
      <i class="fas fa-check-circle"></i>
      <span id="successMessageText"></span>
    </div>

    <!-- Header Section -->
    <header class="text-white shadow-lg py-4">
      <div
        class="container mx-auto px-4 flex flex-col md:flex-row justify-between items-center"
      >
        <a
          href="index.html"
          class="text-3xl font-bold rounded-md hover:text-gray-300 transition duration-300 flex items-center"
        >
          <i class="fas fa-book-open mr-2 text-emerald-400"></i>
          <span class="gradient-text">गामाकौआ</span>
        </a>
        <nav class="mt-4 md:mt-0 hidden md:flex">
          <ul
            class="flex flex-wrap justify-center md:justify-end space-x-4 md:space-x-6 text-base font-medium"
          >
            <li>
              <a
                href="hindi-literature.html"
                class="text-white hover:text-emerald-300 transition duration-300 flex items-center"
              >
                <i class="fas fa-book mr-2"></i>हिंदी साहित्य</a
              >
            </li>
            <li>
              <a
                href="literary-theories.html"
                class="text-white hover:text-emerald-300 transition duration-300 flex items-center"
              >
                <i class="fas fa-scroll mr-2"></i>साहित्यिक सिद्धांत</a
              >
            </li>
            <li>
              <a
                href="story-reviews.html"
                class="text-white hover:text-emerald-300 transition duration-300 flex items-center"
              >
                <i class="fas fa-star mr-2"></i>कहानी समीक्षाएं</a
              >
            </li>
            <li>
              <a
                href="du-study-material.html"
                class="text-white hover:text-emerald-300 transition duration-300 flex items-center"
              >
                <i class="fas fa-graduation-cap mr-2"></i>डीयू अध्ययन सामग्री</a
              >
            </li>
            <!-- Post Blog Button - Visible only for admins -->
            <a href="#" id="postContentLink" class="post-blog-btn hidden">
              <i class="fas fa-plus-circle mr-2"></i>ब्लॉग पोस्ट करें
            </a>

            <!-- User Profile Dropdown - Visible when logged in -->
            <div id="userProfileDropdown" class="profile-dropdown hidden">
              <div class="profile-btn">
                <img
                  src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                  alt="User Profile"
                  class="profile-img"
                />
                <span
                  id="userEmailDisplay"
                  class="text-white font-medium"
                ></span>
              </div>
              <div class="dropdown-content">
                <a href="#"><i class="fas fa-user mr-2"></i>मेरी प्रोफाइल</a>
                <a href="#"
                  ><i class="fas fa-bookmark mr-2"></i>सेव किए गए लेख</a
                >
                <a href="#" id="logoutBtn"
                  ><i class="fas fa-sign-out-alt mr-2"></i>लॉग आउट करें</a
                >
              </div>
            </div>

            <!-- Auth Buttons - Visible when not logged in -->
            <button
              id="loginBtn"
              class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
            >
              लॉग इन
            </button>
            <button
              id="signupBtn"
              class="bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
            >
              साइन अप करें
            </button>
          </ul>
        </nav>
        <button
          id="mobileMenuBtn"
          class="md:hidden text-white focus:outline-none"
        >
          <i class="fas fa-bars text-2xl"></i>
        </button>
      </div>
      <!-- Mobile Menu -->
      <div
        id="mobileMenu"
        class="hidden md:hidden py-4 border-t border-gray-700"
      >
        <div class="flex flex-col space-y-4">
          <a
            href="hindi-literature.html"
            class="text-white hover:text-emerald-300 transition duration-300"
          >
            <i class="fas fa-book mr-2"></i>हिंदी साहित्य
          </a>
          <a
            href="literary-theories.html"
            class="text-white hover:text-emerald-300 transition duration-300"
          >
            <i class="fas fa-scroll mr-2"></i>साहित्यिक सिद्धांत
          </a>
          <a
            href="story-reviews.html"
            class="text-white hover:text-emerald-300 transition duration-300"
          >
            <i class="fas fa-star mr-2"></i>कहानी समीक्षाएं
          </a>
          <a
            href="du-study-material.html"
            class="text-white hover:text-emerald-300 transition duration-300"
          >
            <i class="fas fa-graduation-cap mr-2"></i>डीयू अध्ययन सामग्री
          </a>
          <!-- Post Blog Button - Visible only for admins -->
          <a
            href="#"
            id="mobilePostContentLink"
            class="text-white hover:text-emerald-300 transition duration-300 hidden"
          >
            <i class="fas fa-plus-circle mr-2"></i>ब्लॉग पोस्ट करें
          </a>

          <!-- Mobile User Profile - Visible when logged in -->
          <div
            id="mobileUserProfile"
            class="hidden pt-4 border-t border-gray-600"
          >
            <div class="flex items-center mb-4">
              <img
                src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                alt="User Profile"
                class="profile-img"
              />
              <span
                id="mobileUserEmailDisplay"
                class="text-white font-medium ml-2"
              ></span>
            </div>
            <div class="flex flex-col space-y-2">
              <a href="#" class="text-white hover:text-emerald-300"
                ><i class="fas fa-user mr-2"></i>मेरी प्रोफाइल</a
              >
              <a href="#" class="text-white hover:text-emerald-300"
                ><i class="fas fa-bookmark mr-2"></i>सेव किए गए लेख</a
              >
              <a
                href="#"
                id="mobileLogoutBtn"
                class="text-white hover:text-emerald-300"
                ><i class="fas fa-sign-out-alt mr-2"></i>लॉग आउट करें</a
              >
            </div>
          </div>

          <!-- Mobile Auth Buttons - Visible when not logged in -->
          <button
            id="mobileLoginBtn"
            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            लॉग इन
          </button>
          <button
            id="mobileSignupBtn"
            class="bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            साइन अप करें
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content Section for Story Reviews -->
    <section class="py-16 px-4">
      <div class="container mx-auto content-overlay p-8">
        <h1
          class="text-4xl font-bold text-gray-800 mb-8 text-center hindi-text"
        >
          कहानी समीक्षाएं
        </h1>
        <p class="text-lg text-gray-700 leading-relaxed mb-6 hindi-text">
          इस अनुभाग में, हम विभिन्न भारतीय और विश्व साहित्य की लघु कथाओं की गहन
          समीक्षाएं प्रस्तुत करते हैं। हमारी समीक्षाएं कहानी की प्लॉट, चरित्र
          विकास, विषयों, प्रतीकात्मकता और साहित्यिक तकनीकों का विश्लेषण करती
          हैं।
        </p>
        <p class="text-lg text-gray-700 leading-relaxed mb-6 hindi-text">
          चाहे आप एक पाठक हों जो अपनी अगली कहानी की तलाश में हैं या एक छात्र जो
          साहित्यिक विश्लेषण में अंतर्दृष्टि प्राप्त करना चाहता है, हमारे
          समीक्षाएं आपको कहानी को बेहतर ढंग से समझने और उसकी सराहना करने में मदद
          करेंगी।
        </p>
        <div
          id="articlesContainer"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-10"
        >
          <!-- Articles will be loaded here dynamically -->
          <div class="col-span-full text-center">
            <div id="articlesLoader" class="loader"></div>
            <p id="noArticlesMessage" class="text-gray-400 hidden">
              अभी कोई लेख उपलब्ध नहीं हैं।
            </p>
          </div>
        </div>
        <div class="text-center mt-12">
          <a
            href="index.html"
            class="bg-emerald-600 text-white hover:bg-emerald-700 py-3 px-8 rounded-full transition duration-300 transform hover:scale-105"
          >
            मुख्य पृष्ठ पर वापस जाएँ <i class="fas fa-home ml-2"></i>
          </a>
        </div>
      </div>
    </section>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white py-8 px-4 mt-12">
      <div class="container mx-auto text-center">
        <p class="text-sm rounded-md">
          &copy; 2025 गामाकौआ। सर्वाधिकार सुरक्षित।
          <span class="text-red-400">&hearts;</span> के साथ डिज़ाइन किया गया।
        </p>
        <div class="flex justify-center space-x-6 mt-4">
          <a
            href="#"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            >गोपनीयता नीति</a
          >
          <a
            href="#"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            >सेवा की शर्तें</a
          >
          <a
            href="#"
            id="contactUsLink"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            >हमसे संपर्क करें</a
          >
          <!-- Social Media Links (copied from index.html for consistency) -->
          <a
            href="https://facebook.com"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            aria-label="Facebook"
          >
            <i class="fab fa-facebook-f"></i>
          </a>
          <a
            href="https://twitter.com"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            aria-label="Twitter"
          >
            <i class="fab fa-twitter"></i>
          </a>
          <a
            href="https://instagram.com"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            aria-label="Instagram"
          >
            <i class="fab fa-instagram"></i>
          </a>
          <a
            href="https://linkedin.com"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-300 hover:text-white transition duration-300 rounded-md"
            aria-label="LinkedIn"
          >
            <i class="fab fa-linkedin-in"></i>
          </a>
        </div>
      </div>
    </footer>

    <!-- Back to Top Button -->
    <button
      id="backToTopBtn"
      class="floating-btn opacity-0 transform scale-0"
      style="min-width: 50px; min-height: 50px"
    >
      <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Login Modal -->
    <div
      id="loginModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('loginModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          लॉग इन करें
        </h3>
        <form id="loginForm" class="space-y-4">
          <div>
            <label
              for="loginEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >ईमेल:</label
            >
            <input
              type="email"
              id="loginEmail"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका ईमेल"
              required
            />
          </div>
          <div>
            <label
              for="loginPassword"
              class="block text-gray-700 text-sm font-bold mb-2"
              >पासवर्ड:</label
            >
            <input
              type="password"
              id="loginPassword"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका पासवर्ड"
              required
            />
          </div>
          <button
            type="submit"
            class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            लॉग इन
          </button>
          <div class="text-center mt-4">
            <a
              href="#"
              id="forgotPasswordLink"
              class="text-blue-500 hover:text-blue-700 text-sm hindi-text"
              >पासवर्ड भूल गए?</a
            >
          </div>
        </form>
      </div>
    </div>

    <!-- Signup Modal -->
    <div
      id="signupModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('signupModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          साइन अप करें
        </h3>
        <form id="signupForm" class="space-y-4">
          <div>
            <label
              for="signupEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >ईमेल:</label
            >
            <input
              type="email"
              id="signupEmail"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका ईमेल"
              required
            />
          </div>
          <div>
            <label
              for="signupPassword"
              class="block text-gray-700 text-sm font-bold mb-2"
              >पासवर्ड:</label
            >
            <input
              type="password"
              id="signupPassword"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="नया पासवर्ड"
              required
            />
          </div>
          <button
            type="submit"
            class="w-full bg-emerald-500 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            साइन अप करें
          </button>
        </form>
      </div>
    </div>

    <!-- Forgot Password Modal -->
    <div
      id="forgotPasswordModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('forgotPasswordModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          पासवर्ड रीसेट करें
        </h3>
        <p class="text-gray-700 mb-4 text-center hindi-text">
          अपना ईमेल पता दर्ज करें और हम आपको एक पासवर्ड रीसेट लिंक भेजेंगे।
        </p>
        <form id="forgotPasswordForm" class="space-y-4">
          <div>
            <label
              for="forgotPasswordEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >ईमेल:</label
            >
            <input
              type="email"
              id="forgotPasswordEmail"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका ईमेल"
              required
            />
          </div>
          <button
            type="submit"
            class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            रीसेट लिंक भेजें
          </button>
        </form>
      </div>
    </div>

    <!-- Post Content Modal -->
    <div
      id="postContentModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div
        class="modal-content animate__animated animate__zoomIn max-w-2xl w-full"
      >
        <span class="close-button" onclick="closeModal('postContentModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          नया लेख पोस्ट करें
        </h3>
        <form id="newArticleForm" class="space-y-4">
          <div>
            <label
              for="articleTitle"
              class="block text-gray-700 text-sm font-bold mb-2"
              >शीर्षक:</label
            >
            <input
              type="text"
              id="articleTitle"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="लेख का शीर्षक"
              required
            />
          </div>
          <div>
            <label
              for="articleCategory"
              class="block text-gray-700 text-sm font-bold mb-2"
              >श्रेणी:</label
            >
            <select
              id="articleCategory"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              required
            >
              <option value="">श्रेणी चुनें</option>
              <option value="hindi-literature">हिंदी साहित्य</option>
              <option value="literary-theories">साहित्यिक सिद्धांत</option>
              <option value="story-reviews">कहानी समीक्षाएं</option>
              <option value="du-study-material">डीयू अध्ययन सामग्री</option>
            </select>
          </div>
          <div>
            <label
              for="articleContent"
              class="block text-gray-700 text-sm font-bold mb-2"
              >सामग्री:</label
            >
            <div class="editor-toolbar">
              <button
                type="button"
                class="editor-btn"
                onclick="formatDoc('bold')"
              >
                <i class="fas fa-bold"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDoc('italic')"
              >
                <i class="fas fa-italic"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDoc('underline')"
              >
                <i class="fas fa-underline"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDoc('insertUnorderedList')"
              >
                <i class="fas fa-list-ul"></i>
              </button>
            </div>
            <div
              id="articleContentEditable"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-64 overflow-y-auto"
              contenteditable="true"
              placeholder="लेख की सामग्री यहाँ लिखें..."
              data-text="लेख की सामग्री यहाँ लिखें..."
            ></div>
          </div>
          <button
            type="submit"
            class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            लेख पोस्ट करें
          </button>
        </form>
      </div>
    </div>

    <!-- Edit Article Modal -->
    <div
      id="editArticleModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div
        class="modal-content animate__animated animate__zoomIn max-w-2xl w-full"
      >
        <span class="close-button" onclick="closeModal('editArticleModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          लेख संपादित करें
        </h3>
        <form id="editArticleForm" class="space-y-4">
          <input type="hidden" id="editArticleId" />
          <div>
            <label
              for="editArticleTitle"
              class="block text-gray-700 text-sm font-bold mb-2"
              >शीर्षक:</label
            >
            <input
              type="text"
              id="editArticleTitle"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="लेख का शीर्षक"
              required
            />
          </div>
          <div>
            <label
              for="editArticleCategory"
              class="block text-gray-700 text-sm font-bold mb-2"
              >श्रेणी:</label
            >
            <select
              id="editArticleCategory"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              required
            >
              <option value="">श्रेणी चुनें</option>
              <option value="hindi-literature">हिंदी साहित्य</option>
              <option value="literary-theories">साहित्यिक सिद्धांत</option>
              <option value="story-reviews">कहानी समीक्षाएं</option>
              <option value="du-study-material">डीयू अध्ययन सामग्री</option>
            </select>
          </div>
          <div>
            <label
              for="editArticleContent"
              class="block text-gray-700 text-sm font-bold mb-2"
              >सामग्री:</label
            >
            <div class="editor-toolbar">
              <button
                type="button"
                class="editor-btn"
                onclick="formatDocEdit('bold')"
              >
                <i class="fas fa-bold"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDocEdit('italic')"
              >
                <i class="fas fa-italic"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDocEdit('underline')"
              >
                <i class="fas fa-underline"></i>
              </button>
              <button
                type="button"
                class="editor-btn"
                onclick="formatDocEdit('insertUnorderedList')"
              >
                <i class="fas fa-list-ul"></i>
              </button>
            </div>
            <div
              id="editArticleContentEditable"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-64 overflow-y-auto"
              contenteditable="true"
              placeholder="लेख की सामग्री यहाँ लिखें..."
              data-text="लेख की सामग्री यहाँ लिखें..."
            ></div>
          </div>
          <button
            type="submit"
            class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            लेख अपडेट करें
          </button>
        </form>
      </div>
    </div>

    <!-- Article Detail Modal -->
    <div
      id="articleDetailModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div
        class="modal-content animate__animated animate__zoomIn max-w-3xl w-full"
      >
        <span class="close-button" onclick="closeModal('articleDetailModal')"
          >&times;</span
        >
        <h3
          id="articleDetailTitle"
          class="text-3xl font-bold text-gray-800 mb-4 hindi-text"
        ></h3>
        <p class="text-gray-600 text-sm mb-2">
          <span
            id="articleDetailCategory"
            class="font-semibold text-blue-600"
          ></span>
          - <span id="articleDetailAuthor" class="italic"></span> द्वारा
        </p>
        <p id="articleDetailTimestamp" class="text-gray-500 text-xs mb-4"></p>
        <div
          id="articleDetailContent"
          class="prose max-w-none text-gray-700 leading-relaxed text-base overflow-y-auto h-96"
        ></div>
      </div>
    </div>

    <!-- Auth Required Modal -->
    <div
      id="authRequiredModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('authRequiredModal')"
          >&times;</span
        >
        <h3 class="text-2xl font-bold text-gray-800 mb-4 hindi-text">
          साइन इन आवश्यक है
        </h3>
        <p class="text-gray-700 mb-6 hindi-text">
          इस सुविधा का उपयोग करने के लिए आपको लॉग इन या साइन अप करना होगा।
        </p>
        <div class="auth-required-buttons">
          <button
            id="authLoginBtn"
            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            लॉग इन करें
          </button>
          <button
            id="authSignupBtn"
            class="bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            साइन अप करें
          </button>
        </div>
      </div>
    </div>

    <!-- Admin Access Required Modal -->
    <div
      id="adminAccessModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('adminAccessModal')"
          >&times;</span
        >
        <h3 class="text-2xl font-bold text-gray-800 mb-4 hindi-text">
          व्यवस्थापक पहुँच आवश्यक है
        </h3>
        <p class="text-gray-700 mb-6 hindi-text">
          इस सुविधा का उपयोग करने के लिए आपके पास व्यवस्थापक अधिकार होने चाहिए।
        </p>
        <div class="auth-required-buttons">
          <button
            id="adminAccessLoginBtn"
            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            लॉग इन करें
          </button>
          <button
            id="adminAccessSignupBtn"
            class="bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            साइन अप करें
          </button>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal for Delete -->
    <div
      id="confirmationModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('confirmationModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-4 text-center hindi-text"
        >
          पुष्टि करें
        </h3>
        <p class="text-gray-700 mb-6 text-center hindi-text">
          क्या आप वाकई इस लेख को हटाना चाहते हैं?
        </p>
        <div class="flex justify-center gap-4">
          <button
            id="confirmDeleteBtn"
            class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
          >
            हाँ, हटाएँ
          </button>
          <button
            class="bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-full transition duration-300"
            onclick="closeModal('confirmationModal')"
          >
            नहीं, रहने दें
          </button>
        </div>
      </div>
    </div>

    <!-- Contact Us Modal -->
    <div
      id="contactUsModal"
      class="modal-overlay animate__animated animate__fadeIn"
    >
      <div class="modal-content animate__animated animate__zoomIn">
        <span class="close-button" onclick="closeModal('contactUsModal')"
          >&times;</span
        >
        <h3
          class="text-2xl font-bold text-gray-800 mb-6 text-center hindi-text"
        >
          हमसे संपर्क करें
        </h3>
        <form id="contactForm" class="space-y-4">
          <div>
            <label
              for="contactName"
              class="block text-gray-700 text-sm font-bold mb-2"
              >नाम:</label
            >
            <input
              type="text"
              id="contactName"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका नाम"
              required
            />
          </div>
          <div>
            <label
              for="contactEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >ईमेल:</label
            >
            <input
              type="email"
              id="contactEmail"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="आपका ईमेल"
              required
            />
          </div>
          <div>
            <label
              for="contactMessage"
              class="block text-gray-700 text-sm font-bold mb-2"
              >संदेश:</label
            >
            <textarea
              id="contactMessage"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-32"
              placeholder="आपका संदेश यहाँ लिखें..."
              required
            ></textarea>
          </div>
          <button
            type="submit"
            class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300"
          >
            संदेश भेजें
          </button>
        </form>
      </div>
    </div>

    <script>
      // Base URL for your backend API
      const BASE_URL = "http://localhost:3000/api"; // Make sure this matches your Node.js server port

      // Global user state (now relies on localStorage for persistence)
      let loggedInUser = null; // { email: "user@example.com", isAdmin: false/true }
      let authToken = null; // JWT token

      // Function to load user state from localStorage on page load
      function loadUserState() {
        const storedToken = localStorage.getItem("authToken");
        const storedUser = localStorage.getItem("loggedInUser");
        if (storedToken && storedUser) {
          authToken = storedToken;
          try {
            loggedInUser = JSON.parse(storedUser);
          } catch (e) {
            console.error("Error parsing stored user data:", e);
            clearUserState(); // Clear invalid data
          }
        }
      }

      // Function to save user state to localStorage after login/signup
      function saveUserState(token, user) {
        authToken = token;
        loggedInUser = user;
        localStorage.setItem("authToken", token);
        localStorage.setItem("loggedInUser", JSON.stringify(user));
      }

      // Function to clear user state from localStorage on logout
      function clearUserState() {
        authToken = null;
        loggedInUser = null;
        localStorage.removeItem("authToken");
        localStorage.removeItem("loggedInUser");
      }

      // Function to show success message pop-up
      function showSuccessMessage(message) {
        const successMessage = document.getElementById("successMessage");
        const successMessageText =
          document.getElementById("successMessageText");
        successMessageText.textContent = message;
        successMessage.classList.add("show");
        setTimeout(() => {
          successMessage.classList.remove("show");
        }, 3000); // Message disappears after 3 seconds
      }

      // Function to update UI elements based on login status and user role
      function updateAuthUI() {
        const loginBtn = document.getElementById("loginBtn");
        const signupBtn = document.getElementById("signupBtn");
        const userProfileDropdown = document.getElementById(
          "userProfileDropdown"
        );
        const userEmailDisplay = document.getElementById("userEmailDisplay");
        const mobileLoginBtn = document.getElementById("mobileLoginBtn");
        const mobileSignupBtn = document.getElementById("mobileSignupBtn");
        const mobileUserProfile = document.getElementById("mobileUserProfile");
        const mobileUserEmailDisplay = document.getElementById(
          "mobileUserEmailDisplay"
        );
        const postContentLink = document.getElementById("postContentLink");
        const mobilePostContentLink = document.getElementById(
          "mobilePostContentLink"
        );

        if (loggedInUser) {
          // User is signed in
          loginBtn.classList.add("hidden");
          signupBtn.classList.add("hidden");
          userProfileDropdown.classList.remove("hidden");
          userEmailDisplay.textContent = loggedInUser.email;

          mobileLoginBtn.classList.add("hidden");
          mobileSignupBtn.classList.add("hidden");
          mobileUserProfile.classList.remove("hidden");
          mobileUserEmailDisplay.textContent = loggedInUser.email;

          // Only admin can see the 'Post Content' link/tab
          if (loggedInUser.isAdmin) {
            postContentLink.classList.remove("hidden");
            mobilePostContentLink.classList.remove("hidden");
          } else {
            postContentLink.classList.add("hidden");
            mobilePostContentLink.classList.add("hidden");
          }
        } else {
          // User is signed out
          loginBtn.classList.remove("hidden");
          signupBtn.classList.remove("hidden");
          userProfileDropdown.classList.add("hidden");

          mobileLoginBtn.classList.remove("hidden");
          mobileSignupBtn.classList.remove("hidden");
          mobileUserProfile.classList.add("hidden");

          postContentLink.classList.add("hidden");
          mobilePostContentLink.classList.add("hidden");
        }
        // Load articles relevant to this page's category after auth state is determined
        loadArticles(document.body.dataset.category); // Pass category if set on body
      }

      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById("mobileMenuBtn");
      const mobileMenu = document.getElementById("mobileMenu");
      mobileMenuBtn.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
      });

      // Generic Modal Functions
      function openModal(modalId) {
        document.getElementById(modalId).classList.add("open");
      }

      function closeModal(modalId) {
        document.getElementById(modalId).classList.remove("open");
      }

      // Close modal on outside click
      document.querySelectorAll(".modal-overlay").forEach((overlay) => {
        overlay.addEventListener("click", (e) => {
          if (e.target === overlay) {
            closeModal(overlay.id);
          }
        });
      });

      // Event listeners for opening modals
      document
        .getElementById("loginBtn")
        .addEventListener("click", () => openModal("loginModal"));
      document
        .getElementById("mobileLoginBtn")
        .addEventListener("click", () => openModal("loginModal"));
      document
        .getElementById("signupBtn")
        .addEventListener("click", () => openModal("signupModal"));
      document
        .getElementById("mobileSignupBtn")
        .addEventListener("click", () => openModal("signupModal"));

      // Forgot Password Link in Login Modal
      document
        .getElementById("forgotPasswordLink")
        .addEventListener("click", (e) => {
          e.preventDefault();
          closeModal("loginModal"); // Close login modal
          openModal("forgotPasswordModal"); // Open forgot password modal
        });

      // Auth Required Modal buttons
      document.getElementById("authLoginBtn").addEventListener("click", () => {
        closeModal("authRequiredModal");
        openModal("loginModal");
      });
      document.getElementById("authSignupBtn").addEventListener("click", () => {
        closeModal("authRequiredModal");
        openModal("signupModal");
      });

      // Admin Access Required Modal buttons
      document
        .getElementById("adminAccessLoginBtn")
        .addEventListener("click", () => {
          closeModal("adminAccessModal");
          openModal("loginModal");
        });
      document
        .getElementById("adminAccessSignupBtn")
        .addEventListener("click", () => {
          closeModal("adminAccessModal");
          openModal("signupModal");
        });

      // Login Form Submission (Connects to Backend API: POST /api/auth/login)
      document
        .getElementById("loginForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = document.getElementById("loginEmail").value;
          const password = document.getElementById("loginPassword").value;

          try {
            const response = await fetch(`${BASE_URL}/auth/login`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email, password }),
            });

            const data = await response.json();

            if (response.ok) {
              saveUserState(data.token, {
                email: data.email,
                isAdmin: data.isAdmin,
              }); // Store isAdmin and email from backend response
              showSuccessMessage("सफलतापूर्वक लॉग इन किया गया!");
              closeModal("loginModal");
              updateAuthUI(); // Update UI to reflect logged-in state
            } else {
              showSuccessMessage(data.message || "लॉग इन विफल रहा।");
            }
          } catch (error) {
            console.error("Login error:", error);
            showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
          }
        });

      // Signup Form Submission (Connects to Backend API: POST /api/auth/signup)
      document
        .getElementById("signupForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = document.getElementById("signupEmail").value;
          const password = document.getElementById("signupPassword").value;

          try {
            const response = await fetch(`${BASE_URL}/auth/signup`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email, password }),
            });

            const data = await response.json();

            if (response.ok) {
              showSuccessMessage(
                "सफलतापूर्वक साइन अप किया गया! अब आप लॉग इन कर सकते हैं।"
              );
              closeModal("signupModal");
              // Optionally clear signup form, then open login modal
              document.getElementById("signupEmail").value = "";
              document.getElementById("signupPassword").value = "";
              openModal("loginModal"); // Prompt for login after successful signup
            } else {
              showSuccessMessage(data.message || "साइन अप विफल रहा।");
            }
          } catch (error) {
            console.error("Signup error:", error);
            showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
          }
        });

      // Forgot Password Form Submission (Dummy functionality - requires backend implementation)
      document
        .getElementById("forgotPasswordForm")
        .addEventListener("submit", (e) => {
          e.preventDefault();
          const email = document.getElementById("forgotPasswordEmail").value;
          showSuccessMessage(
            `यदि '${email}' पंजीकृत है, तो एक पासवर्ड रीसेट लिंक भेजा जाएगा (यह सुविधा अभी विकसित की जा रही है)।`
          );
          closeModal("forgotPasswordModal");
          document.getElementById("forgotPasswordEmail").value = ""; // Clear input
        });

      // Logout
      function handleLogout() {
        clearUserState(); // Clear local storage and global state
        showSuccessMessage("सफलतापूर्वक लॉग आउट किया गया!");
        updateAuthUI(); // Update UI to reflect logged-out state
      }
      document
        .getElementById("logoutBtn")
        .addEventListener("click", handleLogout);
      document
        .getElementById("mobileLogoutBtn")
        .addEventListener("click", handleLogout);

      // Rich Text Editor functionality for new article modal
      function formatDoc(command) {
        document.getElementById("articleContentEditable").focus();
        document.execCommand(command, false, null);
      }

      // Rich Text Editor functionality for edit article modal
      function formatDocEdit(command) {
        document.getElementById("editArticleContentEditable").focus();
        document.execCommand(command, false, null);
      }

      // Post Content Link handler - Checks for admin access (client-side UI visibility)
      document
        .getElementById("postContentLink")
        .addEventListener("click", (e) => {
          e.preventDefault();
          if (!loggedInUser) {
            openModal("authRequiredModal"); // Prompt to login/signup
          } else if (!loggedInUser.isAdmin) {
            // Check isAdmin from the loggedInUser state
            openModal("adminAccessModal"); // Inform non-admin users
          } else {
            openModal("postContentModal");
            // Clear form fields when opening for a new post
            document.getElementById("articleTitle").value = "";
            document.getElementById("articleCategory").value = "";
            document.getElementById("articleContentEditable").innerHTML = "";
            // Pre-select category if on a category page
            const currentCategory = document.body.dataset.category;
            if (currentCategory) {
              document.getElementById("articleCategory").value =
                currentCategory;
            }
          }
        });
      document
        .getElementById("mobilePostContentLink")
        .addEventListener("click", (e) => {
          e.preventDefault();
          if (!loggedInUser) {
            openModal("authRequiredModal");
          } else if (!loggedInUser.isAdmin) {
            openModal("adminAccessModal");
          } else {
            openModal("postContentModal");
            document.getElementById("articleTitle").value = "";
            document.getElementById("articleCategory").value = "";
            document.getElementById("articleContentEditable").innerHTML = "";
            const currentCategory = document.body.dataset.category;
            if (currentCategory) {
              document.getElementById("articleCategory").value =
                currentCategory;
            }
          }
        });

      // New Article Form Submission (Connects to Backend API: POST /api/articles)
      document
        .getElementById("newArticleForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          // Client-side validation for admin access, though backend will also enforce
          if (!loggedInUser || !loggedInUser.isAdmin) {
            showSuccessMessage(
              "लेख पोस्ट करने के लिए आपके पास व्यवस्थापक अधिकार होने चाहिए।"
            );
            closeModal("postContentModal");
            openModal("adminAccessModal");
            return;
          }

          const title = document.getElementById("articleTitle").value;
          const category = document.getElementById("articleCategory").value;
          const content = document.getElementById(
            "articleContentEditable"
          ).innerHTML;
          // author and userId will be set by the backend based on the token

          if (!title || !category || !content) {
            showSuccessMessage("कृपया सभी आवश्यक फ़ील्ड भरें!");
            return;
          }

          try {
            console.log("Attempting to post article..."); // Debugging log
            const response = await fetch(`${BASE_URL}/articles`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                "x-auth-token": authToken, // Send the authentication token
              },
              body: JSON.stringify({ title, category, content }), // Do not send author/userId here, backend sets it
            });

            const data = await response.json();
            console.log("Post article response:", response.status, data); // Debugging log

            if (response.ok) {
              showSuccessMessage("लेख सफलतापूर्वक पोस्ट किया गया!");
              closeModal("postContentModal");
              // Re-fetch and re-render articles, ensuring correct category filter is applied
              loadArticles(document.body.dataset.category);
            } else {
              showSuccessMessage(
                data.message || "लेख पोस्ट करने में विफल रहा।"
              );
            }
          } catch (error) {
            console.error("Create article error:", error);
            showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
          }
        });

      // Edit Article Form Submission (Connects to Backend API: PUT /api/articles/:id)
      document
        .getElementById("editArticleForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          if (!loggedInUser) {
            showSuccessMessage("लेख संपादित करने के लिए लॉग इन करें।");
            closeModal("editArticleModal");
            openModal("authRequiredModal");
            return;
          }

          // Client-side check for admin access for editing
          if (!loggedInUser.isAdmin) {
            showSuccessMessage(
              "आपको इस लेख को संपादित करने की अनुमति नहीं है।"
            );
            closeModal("editArticleModal");
            openModal("adminAccessModal");
            return;
          }

          const articleId = document.getElementById("editArticleId").value;
          const title = document.getElementById("editArticleTitle").value;
          const category = document.getElementById("editArticleCategory").value;
          const content = document.getElementById(
            "editArticleContentEditable"
          ).innerHTML;

          if (!title || !category || !content) {
            showSuccessMessage("कृपया सभी आवश्यक फ़ील्ड भरें!");
            return;
          }

          try {
            console.log("Attempting to update article:", articleId); // Debugging log
            const response = await fetch(`${BASE_URL}/articles/${articleId}`, {
              method: "PUT",
              headers: {
                "Content-Type": "application/json",
                "x-auth-token": authToken, // Send authentication token
              },
              body: JSON.stringify({ title, category, content }),
            });

            const data = await response.json();
            console.log("Update article response:", response.status, data); // Debugging log

            if (response.ok) {
              showSuccessMessage("लेख सफलतापूर्वक अपडेट किया गया!");
              closeModal("editArticleModal");
              // Re-fetch and re-render articles, ensuring correct category filter is applied
              loadArticles(document.body.dataset.category);
            } else {
              showSuccessMessage(
                data.message || "लेख अद्यतन करने में विफल रहा।"
              );
              // If backend specifically says unauthorized, show admin access modal
              if (
                data.message &&
                (data.message.includes("authorized") ||
                  data.message.includes("Admin access required"))
              ) {
                openModal("adminAccessModal");
              }
            }
          } catch (error) {
            console.error("Update article error:", error);
            showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
          }
        });

      // Load and Display Articles (Connects to Backend API: GET /api/articles or /api/articles?category=X)
      const articlesContainer = document.getElementById("articlesContainer");
      const articlesLoader = document.getElementById("articlesLoader");
      const noArticlesMessage = document.getElementById("noArticlesMessage");
      let articleToDeleteId = null; // To store the ID of the article to be deleted temporarily

      async function loadArticles(category = null) {
        articlesLoader.style.display = "block"; // Show loader
        noArticlesMessage.classList.add("hidden"); // Hide no articles message
        articlesContainer.innerHTML = ""; // Clear previous articles

        let url = `${BASE_URL}/articles`;
        if (category) {
          url += `?category=${category}`; // Add category filter to URL if provided
        }

        try {
          console.log(`Fetching articles from: ${url}`); // Debugging log
          const response = await fetch(url);
          const articles = await response.json();
          console.log("Fetched articles:", articles); // Debugging log

          if (articles.length === 0) {
            noArticlesMessage.classList.remove("hidden");
            articlesLoader.style.display = "none";
            return;
          }

          // Sort by createdAt (newest first) directly from backend data
          const sortedArticles = [...articles].sort(
            (a, b) => new Date(b.createdAt) - new Date(a.createdAt)
          );

          sortedArticles.forEach((article) => {
            // Use article.createdAt from MongoDB for display
            const displayDate = new Date(article.createdAt).toLocaleString(
              "hi-IN",
              {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
              }
            );

            // Determine if edit/delete buttons should be shown for THIS specific article
            // Frontend checks: Is user logged in AND is admin (backend requires admin for ALL article CRUD)
            const canEditOrDelete = loggedInUser && loggedInUser.isAdmin;

            const articleCard = `
              <div
                class="content-overlay p-6 rounded-lg shadow-lg hover:shadow-xl transition duration-300 transform hover:-translate-y-1 cursor-pointer"
                data-id="${article._id}"
              >
                <span class="text-xs font-semibold text-blue-600 uppercase tracking-wider">${
                  article.category
                }</span>
                <h3 class="text-xl font-bold mt-2 mb-2 text-gray-800 hindi-text">${
                  article.title
                }</h3>
                <p class="text-gray-600 text-sm mb-3">लेखक: ${
                  article.author
                }</p>
                <p class="text-gray-500 text-xs mb-4">प्रकाशित: ${displayDate}</p>
                <div class="text-gray-700 leading-relaxed truncate-3-lines hindi-text">
                  ${article.content}
                </div>
                <button class="mt-4 text-emerald-600 hover:underline read-more-btn" data-id="${
                  article._id
                }">
                  और पढ़ें <i class="fas fa-arrow-right ml-1"></i>
                </button>
                ${
                  canEditOrDelete // Only show edit/delete section if authorized (admin only)
                    ? `
                  <div class="mt-4 flex gap-2">
                    <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded text-sm edit-article-btn" data-id="${article._id}">
                      <i class="fas fa-edit mr-1"></i>संपादित करें
                    </button>
                    <button class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded text-sm delete-article-btn" data-id="${article._id}">
                      <i class="fas fa-trash-alt mr-1"></i>हटाएँ
                    </button>
                  </div>
                `
                    : ""
                }
              </div>
            `;
            articlesContainer.insertAdjacentHTML("beforeend", articleCard);
          });

          // Add event listeners to newly created elements
          articlesContainer
            .querySelectorAll(".content-overlay")
            .forEach((card) => {
              card.addEventListener("click", (e) => {
                // Prevent opening detail modal if edit/delete buttons were clicked
                if (
                  !e.target.closest(".edit-article-btn") &&
                  !e.target.closest(".delete-article-btn")
                ) {
                  const articleId = e.currentTarget.dataset.id;
                  openArticleDetailModal(articleId); // Fetch and display full article
                }
              });
            });

          articlesContainer
            .querySelectorAll(".edit-article-btn")
            .forEach((button) => {
              button.addEventListener("click", async (e) => {
                e.stopPropagation(); // Stop event from bubbling up to the card click
                const articleId = e.currentTarget.dataset.id;

                if (!loggedInUser) {
                  openModal("authRequiredModal");
                  return;
                }
                // Client-side check for admin access for editing
                if (!loggedInUser.isAdmin) {
                  showSuccessMessage(
                    "आपको इस लेख को संपादित करने की अनुमति नहीं है।"
                  );
                  openModal("adminAccessModal");
                  return;
                }

                try {
                  // Fetch the article details to populate the form
                  console.log("Fetching article for edit:", articleId); // Debugging log
                  const response = await fetch(
                    `${BASE_URL}/articles/${articleId}`
                  );
                  const article = await response.json();
                  console.log("Article fetched for edit:", article); // Debugging log

                  if (response.ok) {
                    document.getElementById("editArticleId").value =
                      article._id;
                    document.getElementById("editArticleTitle").value =
                      article.title;
                    document.getElementById("editArticleCategory").value =
                      article.category;
                    document.getElementById(
                      "editArticleContentEditable"
                    ).innerHTML = article.content;
                    openModal("editArticleModal");
                  } else {
                    showSuccessMessage(
                      article.message || "लेख लोड करने में विफल रहा।"
                    );
                  }
                } catch (error) {
                  console.error("Error fetching article for edit:", error);
                  showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
                }
              });
            });

          articlesContainer
            .querySelectorAll(".delete-article-btn")
            .forEach((button) => {
              button.addEventListener("click", async (e) => {
                e.stopPropagation(); // Prevent card click event
                const articleId = e.currentTarget.dataset.id;

                if (!loggedInUser) {
                  openModal("authRequiredModal");
                  return;
                }
                // Client-side check for admin access for deleting
                if (!loggedInUser.isAdmin) {
                  showSuccessMessage("आपको इस लेख को हटाने की अनुमति नहीं है।");
                  openModal("adminAccessModal");
                  return;
                }

                try {
                  console.log("Preparing to delete article:", articleId); // Debugging log
                  articleToDeleteId = articleId; // Store ID for confirmation
                  openModal("confirmationModal");
                } catch (error) {
                  console.error("Error preparing article for delete:", error);
                  showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
                }
              });
            });

          articlesLoader.style.display = "none"; // Hide loader
        } catch (error) {
          console.error("Error fetching articles:", error);
          noArticlesMessage.classList.remove("hidden");
          articlesLoader.style.display = "none";
          showSuccessMessage("लेख लोड करने में विफल रहा।");
        }
      }

      // Handle delete confirmation (Connects to Backend API: DELETE /api/articles/:id)
      document
        .getElementById("confirmDeleteBtn")
        .addEventListener("click", async () => {
          if (!loggedInUser) {
            showSuccessMessage("लेख हटाने के लिए लॉग इन करें।");
            closeModal("confirmationModal");
            openModal("authRequiredModal");
            return;
          }

          // Client-side check for admin access for deleting
          if (!loggedInUser.isAdmin) {
            showSuccessMessage("आपको इस लेख को हटाने की अनुमति नहीं है।");
            closeModal("confirmationModal");
            openModal("adminAccessModal");
            return;
          }

          if (articleToDeleteId) {
            try {
              console.log("Attempting to delete article:", articleToDeleteId); // Debugging log
              const response = await fetch(
                `${BASE_URL}/articles/${articleToDeleteId}`,
                {
                  method: "DELETE",
                  headers: {
                    "x-auth-token": authToken, // Send authentication token
                  },
                }
              );

              const data = await response.json();
              console.log("Delete article response:", response.status, data); // Debugging log

              if (response.ok) {
                showSuccessMessage("लेख सफलतापूर्वक हटाया गया!");
                closeModal("confirmationModal");
                // Re-fetch and re-render articles, ensuring correct category filter is applied
                loadArticles(document.body.dataset.category);
                articleToDeleteId = null; // Clear stored ID
              } else {
                showSuccessMessage(data.message || "लेख हटाने में विफल रहा।");
                if (
                  data.message &&
                  (data.message.includes("authorized") ||
                    data.message.includes("Admin access required"))
                ) {
                  openModal("adminAccessModal"); // If backend specifically says unauthorized
                }
              }
            } catch (error) {
              console.error("Delete article error:", error);
              showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
            }
          } else {
            showSuccessMessage("हटाने के लिए कोई लेख चयनित नहीं है।");
            closeModal("confirmationModal");
          }
        });

      // Open Article Detail Modal and populate content (Connects to Backend API: GET /api/articles/:id)
      async function openArticleDetailModal(articleId) {
        try {
          console.log("Fetching article detail for:", articleId); // Debugging log
          const response = await fetch(`${BASE_URL}/articles/${articleId}`); // Public endpoint
          const article = await response.json();
          console.log("Article detail fetched:", article); // Debugging log

          if (response.ok) {
            document.getElementById("articleDetailTitle").textContent =
              article.title;
            document.getElementById("articleDetailCategory").textContent =
              article.category;
            document.getElementById("articleDetailAuthor").textContent =
              article.author; // Use author from backend (which is postedBy email)
            const timestamp = new Date(article.createdAt).toLocaleString(
              "hi-IN",
              {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
              }
            );
            document.getElementById(
              "articleDetailTimestamp"
            ).textContent = `प्रकाशित: ${timestamp}`;
            document.getElementById("articleDetailContent").innerHTML =
              article.content;
            openModal("articleDetailModal");
          } else {
            showSuccessMessage(
              article.message || "लेख विवरण लोड करने में विफल रहा।"
            );
          }
        } catch (error) {
          console.error("Error fetching article detail:", error);
          showSuccessMessage("नेटवर्क त्रुटि या सर्वर अनुपलब्ध।");
        }
      }

      // Contact Us Modal
      document
        .getElementById("contactUsLink")
        .addEventListener("click", (e) => {
          e.preventDefault();
          openModal("contactUsModal");
        });

      document.getElementById("contactForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const name = document.getElementById("contactName").value;
        const email = document.getElementById("contactEmail").value;
        const message = document.getElementById("contactMessage").value;
        console.log(
          `Contact Form Submission: Name - ${name}, Email - ${email}, Message - ${message}`
        );
        showSuccessMessage("आपका संदेश सफलतापूर्वक भेजा गया!");
        closeModal("contactUsModal");
        document.getElementById("contactForm").reset(); // Clear form
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Load user state from localStorage and update UI, then load articles
        loadUserState(); // Load user state (token, loggedInUser) from local storage
        updateAuthUI(); // Update UI elements based on initial authentication state

        // Back to Top button functionality
        const backToTopBtn = document.getElementById("backToTopBtn");
        const toggleBackToTopButton = () => {
          if (window.scrollY > 300) {
            backToTopBtn.classList.add("opacity-100", "scale-100");
            backToTopBtn.classList.remove("opacity-0", "scale-0");
          } else {
            backToTopBtn.classList.add("opacity-0", "scale-0");
            backToTopBtn.classList.remove("opacity-100", "scale-100");
          }
        };

        window.addEventListener("scroll", toggleBackToTopButton);
        backToTopBtn.addEventListener("click", () => {
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        });
      });
    </script>
  </body>
</html>
